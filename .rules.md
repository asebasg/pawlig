# PawLig: El Estándar de Oro - Guía Maestra de Codificación

Este documento establece las reglas definitivas y obligatorias para el desarrollo en PawLig. Es el manual de referencia para humanos y agentes de IA, diseñado para garantizar un código coherente, mantenible y de calidad excepcional.

## 1. Reglas de Codificación (Coding Style)

- **Indentación**: Usar estrictamente 2 espacios. Prohibido el uso de tabs.
- **Comillas**: Usar comillas dobles (`"`) para todas las importaciones, cadenas de texto y atributos JSX.
- **Punto y Coma**: Todas las sentencias deben finalizar con punto y coma (`;`).
- **Final de Archivo**: Cada archivo debe terminar con exactamente una línea en blanco.
- **Componentes React**:
  - Declaración: Usar funciones estándar (`function Componente() {}`).
  - Extensión: `.tsx` para archivos con JSX, `.ts` para lógica pura.
  - Directivas: `"use client";` o `"use server";` deben ir en la primera línea si son necesarias.
  - Hooks: Seguir el orden estándar (useState, useMemo, useCallback, useEffect).
  - Suspense: Todo componente que use `useSearchParams()` debe estar envuelto en un límite de `<Suspense>`.
- **Tailwind CSS**:
  - Ubicación: Siempre en el atributo `className`.
  - Orden: Layout (flex, grid), Dimensiones (w, h), Espaciado (p, m), Tipografía (text, font), Colores/Efectos (bg, shadow), Estados (hover, focus).
  - Variables: Usar variables CSS semánticas (ej: `text-primary`, `bg-background`) en lugar de hex codes o colores hardcodeados (ej: `bg-purple-600`).

## 2. Convenciones de Nomenclatura (Naming)

- **Variables y Funciones**: `camelCase`.
  - Correcto: `const activeUserCount = 5;`, `function calculateTotal() {}`.
- **Funciones de Componentes**: `PascalCase`.
  - Correcto: `function PetCard() {}`.
- **Tipos e Interfaces**: `PascalCase`.
  - Correcto: `interface UserProfile {}`, `type PetStatus = "AVAILABLE" | "ADOPTED";`.
- **Archivos y Directorios**: `kebab-case` (Minúsculas y guiones).
  - **REGLA DE ORO**: Todos los archivos de componentes deben ser `kebab-case.tsx`.
  - Correcto: `pet-card.tsx`, `adopter-dashboard-client.tsx`, `auth-service.ts`.
- **Prisma (Base de Datos)**:
  - Modelos: `PascalCase` (ej: `User`, `ShelterPet`).
  - Campos: `camelCase` (ej: `createdAt`, `userId`).
  - Enums: Nombre en `PascalCase`, valores en `SCREAMING_SNAKE_CASE` (ej: `enum PetStatus { AVAILABLE, IN_PROCESS }`).
- **Constantes Globales**: `SCREAMING_SNAKE_CASE`.
  - Correcto: `export const MAX_FILE_SIZE = 5000000;`.

## 3. Estructura del Proyecto

El proyecto utiliza Next.js App Router con una organización modular:

- **/app**: Rutas y lógica de servidor.
  - `(auth)`: Grupo de rutas para autenticación.
  - `(dashboard)`: Paneles protegidos por rol (admin, user, shelter, vendor).
  - `(public)`: Páginas abiertas (adopciones, productos, legal, changelog).
  - `api/`: Endpoints de la API RESTful.
- **/components**: Componentes React reutilizables.
  - `ui/`: Componentes base (Botones, inputs, modales).
  - `layout/`: Estructura global (Navbar, Footer, Menús).
  - `forms/`: Lógica de formularios y validaciones.
  - `cards/`: Representación visual de entidades (mascotas, productos).
  - `[feature]/`: Componentes específicos de una funcionalidad.
- **/lib**: El núcleo de la lógica de negocio.
  - `services/`: Funciones de acceso a datos y lógica compleja (Pet, Product, Order).
  - `validations/`: Esquemas de Zod para validación de datos.
  - `context/`: Estados globales (CartContext, etc).
  - `utils/`: Funciones de ayuda y configuración de DB/Cloudinary.
- **/prisma**: Definición del esquema de base de datos.
- **/types**: Definiciones globales de TypeScript.
- **/public**: Assets estáticos (imágenes, iconos).

## 4. Documentación Obligatoria

### 4.1. Resumen JSDoc (Cabecera)

Cada archivo que contenga lógica (servicios, componentes, API routes) debe incluir un bloque JSDoc después de las importaciones:

```typescript
/**
 * [MÉTODO RUTA si aplica] /api/ejemplo (opcional)
 * Descripción: Explicación concisa de la responsabilidad del archivo.
 * Requiere: Requisitos previos (ej: Auth, Parámetros específicos).
 * Implementa: Referencia a Historia de Usuario o funcionalidad (ej: HU-004).
 */
```

### 4.2. Notas de Implementación (Pie de página)

Al final de cada archivo significativo, incluir un bloque de comentario con los detalles técnicos:

```typescript
/*
 * ---------------------------------------------------------------------------
 * NOTAS DE IMPLEMENTACIÓN
 * ---------------------------------------------------------------------------
 *
 * Descripción General:
 * Resumen del propósito y funcionamiento del archivo.
 *
 * Lógica Clave:
 * - Punto 1: Explicación de algoritmos o patrones usados.
 * - Punto 2: Decisiones de diseño importantes.
 *
 * Dependencias Externas:
 * - Librerías o servicios externos y su uso.
 *
 */
```

**Nota**: No usar formato Markdown (negritas, backticks) dentro de estos comentarios.

## 5. Mejores Prácticas y Estándares Técnicos

- **Tipado Fuerte**: Prohibido el uso de `any`. Usar interfaces explícitas o tipos generados por Prisma.
- **Backend Seguro**:
  - Las transacciones de pedidos en `order.service.ts` deben usar Prisma Transactions para asegurar integridad de stock y precio.
  - Validar siempre los datos de entrada con Zod. Usar `ZodError.issues` en lugar de `ZodError.errors` para compatibilidad de tipos.
- **Integración AI**: El modelo estándar es `gemini-2.5-flash` a través del endpoint `/api/ai/refine`.
- **Multimedia**: La configuración de Cloudinary debe ser condicional para evitar fallos en tiempo de construcción (Build time).
- **UI/UX y Accesibilidad**:
  - Fuentes: Inter (Cuerpo), Poppins (Títulos).
  - Iconos: `lucide-react` únicamente.
  - Animaciones: Las animaciones orbitales en páginas de error deben usar `overflow-hidden` en el contenedor padre.
  - Notificaciones: Usar la librería `sonner` para mensajes de feedback.
  - Contraste: Mantener estándares WCAG AA en todos los temas.
  - Hydration: El elemento `<html>` en `layout.tsx` debe incluir `suppressHydrationWarning` para compatibilidad con `next-themes`.

## 6. Qué NO Hacer (Anti-patrones)

- **No hardcodear**: Prohibido usar strings o valores mágicos. Usar `lib/constants.ts`.
- **No mezclar capas**: Los componentes de UI no deben hacer consultas directas a Prisma. Usar la capa de servicios.
- **No dejar basura**: Eliminar `console.log` y comentarios de depuración antes de subir cambios.
- **No ignorar el tipado**: No usar `as any`. Buscar o definir el tipo correcto.
- **No mutar props**: Tratar todos los datos como inmutables.

## 7. Idioma y Localización

- **Código**: Nombres de variables, funciones y clases en inglés (estándar de la industria).
- **Interfaz (UI)**: Todo el texto visible para el usuario debe estar en español.
- **Documentación y Comentarios**: Todo el JSDoc, notas de implementación y comentarios de código deben estar en español.
- **Pull Requests**: Las descripciones y títulos de los PRs deben ser en español.

---

© 2026 PawLig Project - Estandarizado para la Excelencia.
<https://github.com/asebasg/pawlig>
